---
:src: open64-4.2.4-0.src.tar.bz2
:type: compilers
:src_dir: open64-4.2.4-src
:version: '4.2.4'
:compilers:
  gcc:
:compile: |
  CONFIGURE=`pwd`/configure
  mkdir ../build
  cd ../build
  $CONFIGURE --build=x86_64-unknown-linux-gnu --prefix=<%= dest_dir.gsub("compilers/#{compiler_name}/",'compilers/') %> <%= redirect(:configure) %>
  make <%= redirect(:compile) %>
:install: |
  cd ../build
  make install <%= redirect(:install) %>
:module: |
  #%Module1.0#####################################################################
  ##
  ## Alces HPC Software Stack - Compiler module file
  ## Copyright (c) 2008-2012 Alces Software Ltd
  ##
  ################################################################################
  proc ModulesHelp { } {
          global app
          global version
          global appcaps
          global appdir

          puts stderr "Adds `$app-$version' to your environment variables"
          puts stderr ""
          puts stderr "##############"
          puts stderr "ENV after load"
          puts stderr "##############"
          puts stderr "${appcaps}DIR -> base path of application"
          puts stderr "${appcaps}BIN -> bin path of application"
          puts stderr "Adds ${appcaps}BIN to PATH"
          puts stderr ""
  }

  set     app      <%= package.name %>
  set     version  <%= version %>
  set     appcaps  <%= package.caps_name %>
  set     appdir   <%= dest_dir.gsub("compilers/#{compiler_name}/",'compilers/') %>

  module-whatis   "loads the necessary `$app-$version' setup environment"

  setenv ${appcaps}DIR ${appdir}
  setenv ${appcaps}BIN ${appdir}/bin

  prepend-path PATH ${appdir}/bin
  prepend-path LD_LIBRARY_PATH ${appdir}/lib

