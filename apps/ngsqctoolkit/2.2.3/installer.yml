---
:src: NGSQCToolkit_v2.2.3.zip
:src_dir: NGSQCToolkit_v2.2.3
:type: apps
:version: '2.2.3'
:compilers:
  noarch:
:compile: |
  # No-op; this is a noarch perl-based package
:install: |
  mkdir -p <%= dest_dir %>/doc <%= dest_dir %>/bin
  for a in Format-converter Trimming QC Statistics; do
    cp -rv $a/* <%= dest_dir %>/bin
  done
  chmod 755 <%= dest_dir %>/bin/*.pl
  # clean up
  rm -f <%= dest_dir %>/bin/lib/version~
  # sed #!s to use env
  for a in <%= dest_dir %>/bin/*.pl; do
    sed -e 's|#!.*/usr/bin/perl|#!/usr/bin/env perl|g' -i $a
  done
  cp NGSQCToolkitv2.2.3_manual.pdf <%= dest_dir %>/doc
:module: |
  #%Module1.0#####################################################################
  ##
  ## Alces HPC Software Stack - Application module file
  ## Copyright (c) 2008-2012 Alces Software Ltd
  ##
  ################################################################################
  proc ModulesHelp { } {
          global app
          global version
          global appcaps
          global appdir

          puts stderr "Adds `$app-$version' to your environment variables"
          puts stderr ""
          puts stderr "##############"
          puts stderr "ENV after load"
          puts stderr "##############"
          puts stderr "${appcaps}DIR -> base path of application"
          puts stderr "${appcaps}BIN -> bin path of application"
          puts stderr "Adds ${appcaps}BIN to PATH"
          puts stderr ""
  }

  prereq apps/gcc/perl

  set     app      <%= package.name %>
  set     version  <%= version %>
  set     appcaps  <%= package.caps_name %>
  set     appdir   <%= dest_dir %>

  module-whatis   "loads the necessary `$app-$version' setup environment"

  setenv ${appcaps}DIR ${appdir}
  setenv ${appcaps}BIN ${appdir}/bin

  prepend-path PATH ${appdir}/bin
