---
:license: OTHER - See http://samtools.sourceforge.net/
:summary: Provides various utilities for manipulating alignments in the SAM format, including sorting, merging, indexing and generating alignments in a per-position format
:url: http://samtools.sourceforge.net/
:description: |
  SAM (Sequence Alignment/Map) format is a generic format for storing
  large nucleotide sequence alignments. SAM aims to be a format that:

    * Is flexible enough to store all the alignment information
      generated by various alignment programs
    * Is simple enough to be easily generated by alignment programs or
      converted from existing alignment formats
    * Is compact in file size
    * Allows most of operations on the alignment to work on a stream
      without loading the whole alignment into memory
    * Allows the file to be indexed by genomic position to efficiently
      retrieve all reads aligning to a locus

  SAM Tools provide various utilities for manipulating alignments in
  the SAM format, including sorting, merging, indexing and generating
  alignments in a per-position format.
:group: Bioinformatics
:changelog: |
  * Thu May  5 2016 - Ruan G. Ellis <ruan.ellis@alces-software.com>
    - Updated distro dependencies for EL 
  * Thu Oct 24 2013 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - add missing bcftools/vcfutils.pl to bin directory
  * Wed Nov 21 2012 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - add $SAMTOOLSLIB to LD_LIBRARY_PATH
  * Thu Oct 25 2012 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - add missing varfilter.py to bin directory
    - sed hashbang lines for perl and python scripts to use env
  * Wed Oct 10 2012 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - additionally enable shared library build
  * Wed Aug 15 2012 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - updated to 0.1.18
    - refactored to use packager style
  * Thu Jul 14 2011 Steve Norledge
    - updated to 0.1.17
    - added latest link
  * Tue Feb 22 2011 Steve Norledge
    - First created
:src: samtools-0.1.18.tar.bz2
:type: apps
:version: '0.1.18'
:compilers:
  gcc:
:dependencies:
  el:
    - zlib-devel
    - ncurses-devel
:compile: |
  sed -i -e 's|^CFLAGS=.*|CFLAGS= -g -Wall -O2 -fPIC|g' Makefile
  make <%= redirect(:make) %>
  if [ "$(uname -s)" == "Darwin" ]; then
    make libbam.1.dylib-local <%= redirect(:make) %>
    ln -s libbam.1.dylib libbam.dylib
  else
    make libbam.so.1-local <%= redirect(:make) %>
    ln -s libbam.so.1 libbam.so
  fi
  # sed #!s to use env
  for a in misc/*.pl bcftools/*.pl; do
    sed -e 's|#!.*/usr/bin/perl.*|#!/usr/bin/env perl|g' -i $a
  done
  for a in misc/*.py; do
    sed -e 's|#!.*|#!/usr/bin/env python|g' -i $a
  done
:install: |
  mkdir -p <%= dest_dir %>/include <%= dest_dir %>/doc <%= dest_dir %>/lib <%= dest_dir %>/bin <%= dest_dir %>/man/man1
  cp ChangeLog AUTHORS COPYING NEWS <%= dest_dir %>/doc
  cp samtools bcftools/bcftools bcftools/*.pl misc/*.pl misc/maq2sam-long misc/maq2sam-short misc/md5fa misc/md5sum-lite misc/seqtk misc/varfilter.py misc/wgsim <%= dest_dir %>/bin
  cp samtools.1 <%= dest_dir %>/man/man1
  cp *.a <%= dest_dir %>/lib
  shopt -s nullglob
  cp -a *.dylib* *.so* <%= dest_dir %>/lib
  shopt -u nullglob
  cp *.h <%= dest_dir %>/include
  cp -r examples <%= dest_dir %>
:module: |
  setenv ${appcaps}DIR ${appdir}
  setenv ${appcaps}BIN ${appdir}/bin
  setenv ${appcaps}LIB ${appdir}/lib
  setenv ${appcaps}INCLUDE ${appdir}/include
  setenv ${appcaps} ${appdir}/lib/libbam.a

  prepend-path PATH ${appdir}/bin
  prepend-path MANPATH ${appdir}/man
  prepend-path LD_LIBRARY_PATH ${appdir}/lib
