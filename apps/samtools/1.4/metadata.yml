---
:license: MIT
:summary: Provides various utilities for manipulating alignments in the SAM format, including sorting, merging, indexing and generating alignments in a per-position format
:url: http://www.htslib.org/
:description: |
  SAM (Sequence Alignment/Map) format is a generic format for storing
  large nucleotide sequence alignments. SAM aims to be a format that:

    * Is flexible enough to store all the alignment information
      generated by various alignment programs
    * Is simple enough to be easily generated by alignment programs or
      converted from existing alignment formats
    * Is compact in file size
    * Allows most of operations on the alignment to work on a stream
      without loading the whole alignment into memory
    * Allows the file to be indexed by genomic position to efficiently
      retrieve all reads aligning to a locus

  SAM Tools provide various utilities for manipulating alignments in
  the SAM format, including sorting, merging, indexing and generating
  alignments in a per-position format.
:group: Bioinformatics
:changelog: |
  * Tue Mar 14 2017 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - Bumped to latest v1.4 version
    - Added bzip2-devel and xz-devel to list of build dependencies
  * Fri Dec  2 2016 - Ruan G. Ellis <ruan.ellis@alces-software.com>
    - Bumped to latest v1.3.1 version
  * Wed Sep  7 2016 Andrew Provis <andrew.provis@alces-software.com>
    - Updated example templates to Clusterware literal scripts
  * Fri May 29 2015 Ruan G. Ellis <ruan.ellis@alces-software.com>
    - Bumped to latest 1.3 version and included OS dependencies
  * Fri May 29 2015 Ruan G. Ellis <ruan.ellis@alces-software.com>
    - Bumped to latest 1.2 version
  * Thu Jan  8 2015 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - Bumped to latest 1.1 version
  * Wed Sep  3 2014 Ben Armston <ben.armston@alces-software.com>
    - Package for v1.0
    - Added a second example script
  * Wed Mar  5 2014 James Donohue <james.donohue@alces-software.com>
    - Added example script
  * Thu Oct 24 2013 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - add missing bcftools/vcfutils.pl to bin directory
  * Thu Apr  4 2013 James Donohue <james.donohue@alces-software.com>
    - updated to 0.1.19 and added more installation logging
  * Wed Nov 21 2012 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - add $SAMTOOLSLIB to LD_LIBRARY_PATH
  * Thu Oct 25 2012 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - Package for v0.1.8
  * Thu Oct 25 2012 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - add missing varfilter.py to bin directory
    - sed hashbang lines for perl and python scripts to use env
  * Wed Oct 10 2012 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - additionally enable shared library build
  * Wed Aug 15 2012 Mark J. Titorenko <mark.titorenko@alces-software.com>
    - updated to 0.1.18
    - refactored to use packager style
  * Thu Jul 14 2011 Steve Norledge
    - updated to 0.1.17
    - added latest link
  * Tue Feb 22 2011 Steve Norledge
    - First created
:src: samtools-1.4.tar.bz2
:src_dir: samtools-1.4
:type: apps
:version: '1.4'
:compilers:
  gcc:
:dependencies:
  el:
    - zlib-devel
    - ncurses-devel
    - bzip2-devel
    - xz-devel
:compile: |
  sed -i -e 's|^CFLAGS=.*|CFLAGS= -g -Wall -O2 -fPIC|g' Makefile
  make <%= redirect(:make) %>
  # sed #!s to use env
  for a in misc/*.pl; do
    sed -e 's|#!.*/usr/bin/perl.*|#!/usr/bin/env perl|g' -i $a
  done
  for a in misc/*.py; do
    sed -e 's|#!.*|#!/usr/bin/env python|g' -i $a
  done
:sources:
  - samtools.sh.tpl
  - samtools.sh.md
:install: |
  make prefix=<%= dest_dir %> install
  mkdir -p <%= dest_dir %>/include <%= dest_dir %>/doc <%= dest_dir %>/lib
  cp AUTHORS LICENSE NEWS <%= dest_dir %>/doc
  cp *.a <%= dest_dir %>/lib
  cp *.h <%= dest_dir %>/include
  cp -r examples <%= dest_dir %>

  mkdir -p  <%= dest_dir %>/share/clusterware/templates
  mkdir -p  <%= dest_dir %>/share/clusterware/guides
  cp -v <%= source('samtools.sh.tpl') %> <%= dest_dir %>/share/clusterware/templates <%= redirect(:install) %>
  cp -v <%= source('samtools.sh.md') %> <%= dest_dir %>/share/clusterware/guides <%= redirect(:install) %>
:module: |
  setenv ${appcaps}DIR ${appdir}
  setenv ${appcaps}BIN ${appdir}/bin
  setenv ${appcaps}LIB ${appdir}/lib
  setenv ${appcaps}INCLUDE ${appdir}/include
  setenv ${appcaps}EXAMPLES ${appdir}/examples
  setenv ${appcaps} ${appdir}/lib/libbam.a

  setenv ${appcaps}TEMPLATES ${appdir}/share/clusterware/templates
  setenv ${appcaps}EXAMPLEDOCS ${appdir}/share/clusterware/guides
  prepend-path CW_DOCPATH ${appdir}/share/clusterware

  prepend-path PATH ${appdir}/bin
  prepend-path MANPATH ${appdir}/share/man
  prepend-path LD_LIBRARY_PATH ${appdir}/lib
